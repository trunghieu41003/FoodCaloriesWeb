openapi: 3.0.0
info:
  title: My Meal API
  description: API Documentation for My Meal functionalities
  version: 1.0.0
servers:
  - url: http://localhost:3000
tags:
  - name: My meal
    description: Endpoints related to meal management
  - name: User authentication
    description: Endpoints related to user authentication
  - name: User setting
    description: Endpoints related to user setting
  - name: Dashboard
    description: Endpoints related to dashboard
paths:
  # My meal API
  /api/auth/meals:
    get:
      tags:
        - My meal
      summary: Retrieve meal nutrition information by date
      description: Get nutritional information for a user's meals on a specific date.
      parameters:
        - name: userId
          in: query
          required: true
          description: ID of the user
          schema:
            type: integer
        - name: date
          in: query
          required: true
          description: Date to retrieve meal information
          schema:
            type: string
            format: date
      responses:
        200:
          description: Successfully retrieved meal nutrition information
          content:
            application/json:
              schema:
                type: object
                properties:
                  food:
                    type: array
                    items:
                      type: object
                      properties:
                        food_id:
                          type: integer
                        name:
                          type: string
                        calories:
                          type: string
                        protein:
                          type: string
                        fat:
                          type: string
                        carbs:
                          type: string

  /api/meals/{meal_id}/foods/{food_id}:
    get:
      tags:
        - My meal
      summary: Retrieve food nutrition information in a meal
      description: Retrieve detailed nutritional information of a specific food item in a meal.
      parameters:
        - name: meal_id
          in: path
          required: true
          schema:
            type: integer
        - name: food_id
          in: path
          required: true
          schema:
            type: integer
        - name: userId
          in: query
          required: true
          description: ID of the user
          schema:
            type: integer
        - name: date
          in: query
          required: true
          description: Date to retrieve the food information
          schema:
            type: string
            format: date
      responses:
        200:
          description: Successfully retrieved food information
          content:
            application/json:
              schema:
                type: object
                properties:
                  foodNutrition:
                    type: object
                    properties:
                      food_id:
                        type: integer
                      calories:
                        type: string
                      protein:
                        type: string
                      fat:
                        type: string
                      carbs:
                        type: string

    put:
      tags:
        - My meal
      summary: Update portion and size of a food item
      description: Update the portion and size of a food item in a specific meal.
      parameters:
        - name: meal_id
          in: path
          required: true
          schema:
            type: integer
        - name: food_id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: integer
                date:
                  type: string
                  format: date
                portion:
                  type: integer
                size:
                  type: integer
      responses:
        200:
          description: Successfully updated food information
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  foodNutrition:
                    type: object
                    properties:
                      food_id:
                        type: integer
                      calories:
                        type: string
                      protein:
                        type: string
                      fat:
                        type: string
                      carbs:
                        type: string

    delete:
      tags:
        - My meal
      summary: Remove food item from a meal
      description: Remove a specific food item from a meal.
      parameters:
        - name: meal_id
          in: path
          required: true
          schema:
            type: integer
        - name: food_id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: integer
                date:
                  type: string
                  format: date
      responses:
        200:
          description: Successfully removed food item from meal
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string

  /api/meals/{meal_id}/foods:
    post:
      tags:
        - My meal
      summary: Add food to meal
      description: Add a new food item to a specific meal.
      parameters:
        - name: meal_id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: integer
                date:
                  type: string
                  format: date
                foodId:
                  type: integer
                portion:
                  type: integer
                size:
                  type: integer
      responses:
        200:
          description: Successfully added food to meal
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  food:
                    type: array
                    items:
                      type: object
                      properties:
                        food_id:
                          type: integer
                        name:
                          type: string
                        calories:
                          type: string
                        protein:
                          type: string
                        fat:
                          type: string
                        carbs:
                          type: string

  /api/diaries:
    post:
      tags:
        - My meal
      summary: Add new diary
      description: Add a new diary entry for the specified date and user.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: integer
                  description: ID of the user
                date:
                  type: string
                  format: date
                  description: The date for the diary entry
      responses:
        200:
          description: Successfully added diary
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Diary created successfully"
                  diary:
                    type: object
                    properties:
                      diary_id:
                        type: integer
                        description: ID of the newly created diary
                      user_id:
                        type: integer
                        description: ID of the user associated with the diary
                      calories_consumed:
                        type: string
                        nullable: true
                        description: Total calories consumed (if any)
                      calories_remaining:
                        type: string
                        description: Remaining calories allowed
                      protein_consumed:
                        type: string
                        nullable: true
                        description: Total protein consumed (if any)
                      protein_remaining:
                        type: string
                        description: Remaining protein allowed
                      fat_consumed:
                        type: string
                        nullable: true
                        description: Total fat consumed (if any)
                      fat_remaining:
                        type: string
                        description: Remaining fat allowed
                      carbs_consumed:
                        type: string
                        nullable: true
                        description: Total carbohydrates consumed (if any)
                      carbs_remaining:
                        type: string
                        description: Remaining carbohydrates allowed
                      date:
                        type: string
                        format: date
                        description: The date of the diary entry
        400:
          description: Invalid input data
        500:
          description: Internal server error

  # Authentication API
  /api/users/signup:
    post:
      tags:
        - User authentication
      summary: User Sign Up
      description: This endpoint allows a new user to register.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Name of the user
                  example: "Hieu"
                email:
                  type: string
                  description: Email address of the user
                  example: "Hieuv3@example.com"
                password:
                  type: string
                  description: User password
                  example: "123456"
                height:
                  type: number
                  description: Height in centimeters
                  example: 170
                weight:
                  type: number
                  description: Weight in kilograms
                  example: 150
                birthday:
                  type: string
                  format: date
                  description: User's birthday
                  example: "2003-04-12"
                gender:
                  type: string
                  description: User's gender
                  example: "male"
                activity_level:
                  type: string
                  description: User's activity level
                  example: "moderate"
                goal_type:
                  type: string
                  description: The user's fitness goal type
                  example: "weight loss"
                weight_goal:
                  type: number
                  description: The user's target weight
                  example: 100
                date:
                  type: string
                  format: date
                  description: The registration date
                  example: "2024-01-01"
      responses:
        200:
          description: Successfully registered
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Đăng ký thành công"
                  user:
                    type: object
                    properties:
                      user_id:
                        type: integer
                        example: 1
                      name:
                        type: string
                        example: "Hieu"
                      height:
                        type: string
                        example: "170.00"
                      weight:
                        type: string
                        example: "150.00"
                      birthday:
                        type: string
                        example: "2003-04-12"
                      email:
                        type: string
                        example: "Hieuv3@example.com"
                      password:
                        type: string
                        example: "$2b$10$UocTJzKxXiWWtF7EytyKX.4EmkiScJvbBLQSODDFegeghlzKkCLA2"
                      calories_daily:
                        type: string
                        example: "3316.88"
                      activity_level:
                        type: string
                        example: "moderate"
                      gender:
                        type: string
                        example: "male"
                  goal:
                    type: array
                    items:
                      type: object
                      properties:
                        goal_type:
                          type: string
                          example: "weight loss"
                        weight_goal:
                          type: number
                          example: 100
                        date:
                          type: string
                          example: "2026-09-22"

  /api/users/login:
    post:
      tags:
        - User authentication
      summary: User Login
      description: This endpoint allows a user to log in.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: User's email address
                  example: "Hieuv3@example.com"
                password:
                  type: string
                  description: User's password
                  example: "123456"
                date:
                  type: string
                  format: date
                  description: The login date
                  example: "2024-01-01"
      responses:
        200:
          description: Successfully logged in
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Đăng nhập thành công"
                  token:
                    type: string
                    example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImVtYWlsIjoiSGlldXYzQGV4YW1wbGUuY29tIiwiaWF0IjoxNzI5NTc5ODYyLCJleHAiOjE3Mjk1ODM0NjJ9.9zoy94W-DxCc7c0Q_gPZ5SteUbrIz2Oh1cf1wlTKNhw"

  # Setting API
  /api/users/{user_id}:
    get:
      tags:
        - User setting
      summary: Get user information
      description: Get the information of a specific user.
      parameters:
        - name: user_id
          in: path
          required: true
          description: ID of the user
          schema:
            type: integer
      responses:
        200:
          description: get successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Đăng ký thành công"
                  user:
                    type: object
                    properties:
                      user_id:
                        type: integer
                        example: 1
                      name:
                        type: string
                        example: "Hieu"
                      height:
                        type: string
                        example: "170.00"
                      weight:
                        type: string
                        example: "150.00"
                      birthday:
                        type: string
                        example: "2003-04-12"
                      email:
                        type: string
                        example: "Hieuv3@example.com"
                      password:
                        type: string
                        example: "$2b$10$UocTJzKxXiWWtF7EytyKX.4EmkiScJvbBLQSODDFegeghlzKkCLA2"
                      calories_daily:
                        type: string
                        example: "3316.88"
                      activity_level:
                        type: string
                        example: "moderate"
                      gender:
                        type: string
                        example: "male"
                  goal:
                    type: array
                    items:
                      type: object
                      properties:
                        goal_type:
                          type: string
                          example: "weight loss"
                        weight_goal:
                          type: number
                          example: 100
                        date:
                          type: string
                          example: "2026-09-22"

    put:
      tags:
        - User setting
      summary: Update user information
      description: Update the information of a specific user.
      parameters:
        - name: user_id
          in: path
          required: true
          description: ID of the user
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                height:
                  type: number
                weight:
                  type: number
                birthday:
                  type: string
                  format: date
                gender:
                  type: string
                  enum: [male, female]
                activity_level:
                  type: string
                  enum:
                    [not very active, moderately active, active, very active]
                goal_type:
                  type: string
                  enum: [weight loss, weight gain]
                weight_goal:
                  type: number
      responses:
        200:
          description: Successfully updated user information
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Update successfully"
                  user:
                    type: object
                    properties:
                      user_id:
                        type: integer
                        example: 1
                      name:
                        type: string
                        example: "Hieu"
                      height:
                        type: string
                        example: "170.00"
                      weight:
                        type: string
                        example: "150.00"
                      birthday:
                        type: string
                        format: date
                        example: "2003-04-12"
                      email:
                        type: string
                        example: "Hieuv1@example.com"
                      password:
                        type: string
                        example: "$2b$10$Vk2..uGK7tmJvQmsRzAli.qiiIXMogpOIA.IyynCzr2EcvbKiWFia"
                      calories_daily:
                        type: string
                        example: "3316.88"
                      activity_level:
                        type: string
                        example: "moderately active"
                      gender:
                        type: string
                        example: "male"

  # Dashboard API
  /api/diaries/meals:
    get:
      tags:
        - Dashboard
      summary: Get nutrition for a specific date
      description: Retrieve nutrition information (calories, protein, fat, carbs) consumed and remaining for a user on a specific date.
      parameters:
        - name: userId
          in: query
          required: true
          description: ID of the user
          schema:
            type: integer
        - name: date
          in: query
          required: true
          description: Date of the meal
          schema:
            type: string
            format: date
      responses:
        200:
          description: Successfully retrieved nutrition information for the given date
          content:
            application/json:
              schema:
                type: object
                properties:
                  diary:
                    type: object
                    properties:
                      diary_id:
                        type: integer
                        example: 1
                      user_id:
                        type: integer
                        example: 1
                      calories_consumed:
                        type: string
                        example: "288.89"
                      calories_remaining:
                        type: string
                        example: "2166.11"
                      protein_consumed:
                        type: string
                        example: "15.56"
                      protein_remaining:
                        type: string
                        example: "168.57"
                      fat_consumed:
                        type: string
                        example: "11.11"
                      fat_remaining:
                        type: string
                        example: "70.72"
                      carbs_consumed:
                        type: string
                        example: "37.78"
                      carbs_remaining:
                        type: string
                        example: "207.72"
                      date:
                        type: string
                        format: date-time
                        example: "2023-12-31T17:00:00.000Z"
